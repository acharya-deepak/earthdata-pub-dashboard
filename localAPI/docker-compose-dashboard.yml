version: "3.1"
services:
  dashboard:
    image: node:12.18.0
    network_mode: "service:shim"
    command:
      bash -c "npm rebuild node-sass && npm run serve"
    working_dir:
      /dashboard
    volumes:
      - ../:/dashboard:cached
    environment:
      - APIROOT=http://localhost:8080
      - FORMS_URL=http://localhost:8081
      - OVERVIEW_URL=/
      - HIDE_PDR=true
      - DAAC_NAME=local
      - STAGE=LOCALHOST-Development
      - SHOW_DISTRIBUTION_API_METRICS=false
      - SHOW_TEA_METRICS=false
      - AUTH_METHOD=earthdata
  shim:   # empty container to open ports
    network_mode: "host"
    image: node:12.18.0
    command:
      bash -c "tail -f /dev/null"
    working_dir:
      /dashboard
    volumes:
      - ../:/dashboard:cached
    ports:
      - "3000:3000"
